using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Http;
using DAL;
using System.Data.Entity;
using Model;
using System.Web.Http.Description;
using POSApi.ExtensionMethod;

namespace POSApi.Controllers
{
    [RoutePrefix("api/PurchaseOrderItems")]
    public class PurchaseOrderItemsController : ApiController
    {
        private GrandShoesEntities Entities = new GrandShoesEntities();
        public PurchaseOrderItemsController()
        {
            Entities.Configuration.LazyLoadingEnabled = false;
            Entities.Configuration.ProxyCreationEnabled = false;
        }
        [Route("AddPurchaseOrderItems")]
        // Post: AddPurchaseOrderItems
        public IHttpActionResult AddPurchaseOrderItems(PurchaseOrderItemModel OrderItem)
        {
            DAL.PurchaseOrderItem Order = new DAL.PurchaseOrderItem();

            Order.PurchaseOrderId = OrderItem.PurchaseOrderId;
            Order.ProductId = OrderItem.ProductId;
            Order.Amount = OrderItem.Amount;
            Order.ProductStyleId = OrderItem.ProductStyleId;
            Order.SizeGridId = OrderItem.SizeGridId;
            Order.ColorId = OrderItem.ColorId;
            Order.SuplierStyle = OrderItem.SuplierStyle;


            Order.ItemSize1 = (OrderItem.ItemSize1??0); Order.ItemSize2 = (OrderItem.ItemSize2??0); Order.ItemSize3 = (OrderItem.ItemSize3??0); Order.ItemSize4 = (OrderItem.ItemSize4??0);
            Order.ItemSize5 = (OrderItem.ItemSize5??0); Order.ItemSize6 = (OrderItem.ItemSize6??0); Order.ItemSize7 = (OrderItem.ItemSize7??0); Order.ItemSize8 = (OrderItem.ItemSize8??0);
            Order.ItemSize9 = (OrderItem.ItemSize9??0); Order.ItemSize10 = (OrderItem.ItemSize10??0); Order.ItemSize11 = (OrderItem.ItemSize11??0); Order.ItemSize12 = (OrderItem.ItemSize12??0);
            Order.ItemSize13 = (OrderItem.ItemSize13??0); Order.ItemSize14 = (OrderItem.ItemSize14??0); Order.ItemSize15 = (OrderItem.ItemSize15??0); Order.ItemSize16 = (OrderItem.ItemSize16??0);
            Order.ItemSize17 = (OrderItem.ItemSize17??0); Order.ItemSize18 = (OrderItem.ItemSize18??0); Order.ItemSize19 = (OrderItem.ItemSize19??0); Order.ItemSize20 = (OrderItem.ItemSize20??0);
            Order.ItemSize21 = (OrderItem.ItemSize21??0); Order.ItemSize22 = (OrderItem.ItemSize22??0); Order.ItemSize23 = (OrderItem.ItemSize23??0); Order.ItemSize24 = (OrderItem.ItemSize24??0);
            Order.ItemSize25 = (OrderItem.ItemSize25??0); Order.ItemSize26 = (OrderItem.ItemSize26??0); Order.ItemSize27 = (OrderItem.ItemSize27??0); Order.ItemSize28 = (OrderItem.ItemSize28??0);
            Order.ItemSize29 = (OrderItem.ItemSize29??0); Order.ItemSize30 = (OrderItem.ItemSize30??0);

            Order.QuantitySize1 = (OrderItem.QuantitySize1??0); Order.QuantitySize2 = (OrderItem.QuantitySize2??0); Order.QuantitySize3 = (OrderItem.QuantitySize3??0); Order.QuantitySize4 = (OrderItem.QuantitySize4??0);
            Order.QuantitySize5 = (OrderItem.QuantitySize5??0); Order.QuantitySize6 = (OrderItem.QuantitySize6??0); Order.QuantitySize7 = (OrderItem.QuantitySize7??0); Order.QuantitySize8 = (OrderItem.QuantitySize8??0);
            Order.QuantitySize9 = (OrderItem.QuantitySize9??0); Order.QuantitySize10 = (OrderItem.QuantitySize10??0); Order.QuantitySize11 = (OrderItem.QuantitySize11??0); Order.QuantitySize12 = (OrderItem.QuantitySize12??0);
            Order.QuantitySize13 = (OrderItem.QuantitySize13??0); Order.QuantitySize14 = (OrderItem.QuantitySize14??0); Order.QuantitySize15 = (OrderItem.QuantitySize15??0); Order.QuantitySize16 = (OrderItem.QuantitySize16??0);
            Order.QuantitySize17 = (OrderItem.QuantitySize17??0); Order.QuantitySize18 = (OrderItem.QuantitySize18??0); Order.QuantitySize19 = (OrderItem.QuantitySize19??0); Order.QuantitySize20 = (OrderItem.QuantitySize20??0);
            Order.QuantitySize21 = (OrderItem.QuantitySize21??0); Order.QuantitySize22 = (OrderItem.QuantitySize22??0); Order.QuantitySize23 = (OrderItem.QuantitySize23??0); Order.QuantitySize24 = (OrderItem.QuantitySize24??0);
            Order.QuantitySize25 = (OrderItem.QuantitySize25??0); Order.QuantitySize26 = (OrderItem.QuantitySize26??0); Order.QuantitySize27 = (OrderItem.QuantitySize27??0); Order.QuantitySize28 = (OrderItem.QuantitySize28??0);
            Order.QuantitySize29 = (OrderItem.QuantitySize29??0); Order.QuantitySize30 = (OrderItem.QuantitySize30??0);

            Order.CostSize1 = OrderItem.CostSize1; Order.CostSize2 = OrderItem.CostSize2; Order.CostSize3 = OrderItem.CostSize3; Order.CostSize4 = OrderItem.CostSize4;
            Order.CostSize5 = OrderItem.CostSize5; Order.CostSize6 = OrderItem.CostSize6; Order.CostSize7 = OrderItem.CostSize7; Order.CostSize8 = OrderItem.CostSize8;
            Order.CostSize9 = OrderItem.CostSize9; Order.CostSize10 = OrderItem.CostSize10; Order.CostSize11 = OrderItem.CostSize11; Order.CostSize12 = OrderItem.CostSize12;
            Order.CostSize13 = OrderItem.CostSize13; Order.CostSize14 = OrderItem.CostSize14; Order.CostSize15 = OrderItem.CostSize15; Order.CostSize16 = OrderItem.CostSize16;
            Order.CostSize17 = OrderItem.CostSize17; Order.CostSize18 = OrderItem.CostSize18; Order.CostSize19 = OrderItem.CostSize19; Order.CostSize20 = OrderItem.CostSize20;
            Order.CostSize21 = OrderItem.CostSize21; Order.CostSize22 = OrderItem.CostSize22; Order.CostSize23 = OrderItem.CostSize23; Order.CostSize24 = OrderItem.CostSize24;
            Order.CostSize25 = OrderItem.CostSize25; Order.CostSize26 = OrderItem.CostSize26; Order.CostSize27 = OrderItem.CostSize27; Order.CostSize28 = OrderItem.CostSize28;
            Order.CostSize29 = OrderItem.CostSize29; Order.CostSize30 = OrderItem.CostSize30;

            Order.IsActive = true;
            Entities.PurchaseOrderItems.Add(Order);
            Entities.SaveChanges();
            int id = Order.PurchaseOrderId;
            return Ok(id);
        }
        [HttpGet]
        [Route("ProductsAutocomplete")]
        public IHttpActionResult ProductsAutocomplete(string name)
        {
            var list = Entities.PurchaseOrderItems.GroupBy(a => a.ProductId)
                  .Select(g => g.FirstOrDefault()).Include(x=>x.Product)
                  .ToList(); 
            
            var data = list.Where(x => x.IsActive == true && x.Product.ProductSKU.Contains(name)).Distinct().ToList().Select(m => new PurchaseOrderItemModel
            {
                ProductSKU = m.Product.ProductSKU,
                ID = m.ID,
               
            }).ToList();
            return Ok(data);
        }
        [HttpGet]
        [Route("ProductsStyleAutocomplete")]
        public IHttpActionResult ProductsStyleAutocomplete(string name)
        {
            var list = Entities.PurchaseOrderItems.GroupBy(a => a.ProductStyleId)
                 .Select(g => g.FirstOrDefault()).Include(x => x.Product).Include(x => x.ProductStyle).Include(x => x.SizeGrid)
                 .ToList();

            var data = list.Where(x => x.IsActive == true && x.Product.ProductSKU.Contains(name)).Distinct().ToList().Select(m => new PurchaseOrderItemModel
            {
                ProductStyleSKU = m.ProductStyle.StyleSKU,
                ID = m.ID,

            }).ToList();
            return Ok(data);
        }

        // GET: All PurchaseOrderItems
        [Route("GetAllPurchaseOrderItems")]
        public IHttpActionResult GetAllPurchaseOrderItems()
        {
            var OrderList = Entities.PurchaseOrderItems.Include(s => s.Color).Include(s =>s.Product).Include(s=>s.ProductStyle).Where(s => s.IsActive == true).ToList().
            Select(m => new Model.PurchaseOrderItemModel
            {
                ID = m.ID,
                PurchaseOrderId = m.PurchaseOrderId,
                ProductId = m.ProductId,
                Amount = m.Amount,
                SizeGridId = m.SizeGridId,
                ColorId = m.ColorId,
                SuplierStyle = m.SuplierStyle,
                ProductStyleId = m.ProductStyleId,

                ItemSize1 = m.ItemSize1,
                ItemSize2 = m.ItemSize2,
                ItemSize3 = m.ItemSize3,
                ItemSize4 = m.ItemSize4,
                ItemSize5 = m.ItemSize5,
                ItemSize6 = m.ItemSize6,
                ItemSize7 = m.ItemSize7,
                ItemSize8 = m.ItemSize8,
                ItemSize9 = m.ItemSize9,
                ItemSize10 = m.ItemSize10,
                ItemSize11 = m.ItemSize11,
                ItemSize12 = m.ItemSize12,
                ItemSize13 = m.ItemSize13,
                ItemSize14 = m.ItemSize14,
                ItemSize15 = m.ItemSize15,
                ItemSize16 = m.ItemSize16,
                ItemSize17 = m.ItemSize17,
                ItemSize18 = m.ItemSize18,
                ItemSize19 = m.ItemSize19,
                ItemSize20 = m.ItemSize20,
                ItemSize21 = m.ItemSize21,
                ItemSize22 = m.ItemSize22,
                ItemSize23 = m.ItemSize23,
                ItemSize24 = m.ItemSize24,
                ItemSize25 = m.ItemSize25,
                ItemSize26 = m.ItemSize26,
                ItemSize27 = m.ItemSize27,
                ItemSize28 = m.ItemSize28,
                ItemSize29 = m.ItemSize29,
                ItemSize30 = m.ItemSize30,

                QuantitySize1 = m.QuantitySize1,
                QuantitySize2 = m.QuantitySize2,
                QuantitySize3 = m.QuantitySize3,
                QuantitySize4 = m.QuantitySize4,
                QuantitySize5 = m.QuantitySize5,
                QuantitySize6 = m.QuantitySize6,
                QuantitySize7 = m.QuantitySize7,
                QuantitySize8 = m.QuantitySize8,
                QuantitySize9 = m.QuantitySize9,
                QuantitySize10 = m.QuantitySize10,
                QuantitySize11 = m.QuantitySize11,
                QuantitySize12 = m.QuantitySize12,
                QuantitySize13 = m.QuantitySize13,
                QuantitySize14 = m.QuantitySize14,
                QuantitySize15 = m.QuantitySize15,
                QuantitySize16 = m.QuantitySize16,
                QuantitySize17 = m.QuantitySize17,
                QuantitySize18 = m.QuantitySize18,
                QuantitySize19 = m.QuantitySize19,
                QuantitySize20 = m.QuantitySize20,
                QuantitySize21 = m.QuantitySize21,
                QuantitySize22 = m.QuantitySize22,
                QuantitySize23 = m.QuantitySize23,
                QuantitySize24 = m.QuantitySize24,
                QuantitySize25 = m.QuantitySize25,
                QuantitySize26 = m.QuantitySize26,
                QuantitySize27 = m.QuantitySize27,
                QuantitySize28 = m.QuantitySize28,
                QuantitySize29 = m.QuantitySize29,
                QuantitySize30 = m.QuantitySize30,

                CostSize1 = m.CostSize1,
                CostSize2 = m.CostSize2,
                CostSize3 = m.CostSize3,
                CostSize4 = m.CostSize4,
                CostSize5 = m.CostSize5,
                CostSize6 = m.CostSize6,
                CostSize7 = m.CostSize7,
                CostSize8 = m.CostSize8,
                CostSize9 = m.CostSize9,
                CostSize10 = m.CostSize10,
                CostSize11 = m.CostSize11,
                CostSize12 = m.CostSize12,
                CostSize13 = m.CostSize13,
                CostSize14 = m.CostSize14,
                CostSize15 = m.CostSize15,
                CostSize16 = m.CostSize16,
                CostSize17 = m.CostSize17,
                CostSize18 = m.CostSize18,
                CostSize19 = m.CostSize19,
                CostSize20 = m.CostSize20,
                CostSize21 = m.CostSize21,
                CostSize22 = m.CostSize22,
                CostSize23 = m.CostSize23,
                CostSize24 = m.CostSize24,
                CostSize25 = m.CostSize25,
                CostSize26 = m.CostSize26,
                CostSize27 = m.CostSize27,
                CostSize28 = m.CostSize28,
                CostSize29 = m.CostSize29,
                CostSize30 = m.CostSize30,
                IsActive = m.IsActive,
                autoCompleteColorName = m.Color?.Code,
                autoCompleteProductName=m.Product.ProductSKU,
                autoCompleteProductStyleName=m.ProductStyle.StyleSKU,
            }).ToList();
            return Ok(OrderList);
        }
       
        [HttpGet]
        [AllowAnonymous]
        [Route("getDetails")]
        public List<PurchaseOrderItem> GetProductStyles()
        {
            var list = Entities.PurchaseOrderItems.Where(x => x.IsActive == true).Include(x=>x.Product).Include(x=>x.PurchaseOrder).Include(x=>x.ProductStyle).ToList();
            return list;
        }
        //get All order items by order number
        [HttpGet]
        [Route("getByOrderId")]
        public List<PurchaseOrderItem> GetItemByOrderId(int id)
        {
            var list = Entities.PurchaseOrderItems.Where(x => x.IsActive == true && x.PurchaseOrderId == id).Include(x=>x.Product).Include(x=>x.Color).ToList();
            return list;
        }
        [Route("GetAllPurchaseOrderItemsByPurchaseOrderId")]
        public IHttpActionResult GetAllPurchaseOrderItemsByPurchaseOrderId(int PurchaseOrderId)
        {
            var OrderList = Entities.PurchaseOrderItems.Include(s => s.Color).Include(s => s.Product).Where(s => s.IsActive == true && s.PurchaseOrderId== PurchaseOrderId).ToList().Select(m => new Model.PurchaseOrderItemModel
            {
                ID = m.ID,
                PurchaseOrderId = m.PurchaseOrderId,
                ProductId = m.ProductId,
                Amount = m.Amount,
                SizeGridId = m.SizeGridId,
                ColorId = m.ColorId,
                SuplierStyle = m.SuplierStyle,
                ProductStyleId = m.ProductStyleId,

                ItemSize1 = m.ItemSize1,
                ItemSize2 = m.ItemSize2,
                ItemSize3 = m.ItemSize3,
                ItemSize4 = m.ItemSize4,
                ItemSize5 = m.ItemSize5,
                ItemSize6 = m.ItemSize6,
                ItemSize7 = m.ItemSize7,
                ItemSize8 = m.ItemSize8,
                ItemSize9 = m.ItemSize9,
                ItemSize10 = m.ItemSize10,
                ItemSize11 = m.ItemSize11,
                ItemSize12 = m.ItemSize12,
                ItemSize13 = m.ItemSize13,
                ItemSize14 = m.ItemSize14,
                ItemSize15 = m.ItemSize15,
                ItemSize16 = m.ItemSize16,
                ItemSize17 = m.ItemSize17,
                ItemSize18 = m.ItemSize18,
                ItemSize19 = m.ItemSize19,
                ItemSize20 = m.ItemSize20,
                ItemSize21 = m.ItemSize21,
                ItemSize22 = m.ItemSize22,
                ItemSize23 = m.ItemSize23,
                ItemSize24 = m.ItemSize24,
                ItemSize25 = m.ItemSize25,
                ItemSize26 = m.ItemSize26,
                ItemSize27 = m.ItemSize27,
                ItemSize28 = m.ItemSize28,
                ItemSize29 = m.ItemSize29,
                ItemSize30 = m.ItemSize30,

                QuantitySize1 = m.QuantitySize1,
                QuantitySize2 = m.QuantitySize2,
                QuantitySize3 = m.QuantitySize3,
                QuantitySize4 = m.QuantitySize4,
                QuantitySize5 = m.QuantitySize5,
                QuantitySize6 = m.QuantitySize6,
                QuantitySize7 = m.QuantitySize7,
                QuantitySize8 = m.QuantitySize8,
                QuantitySize9 = m.QuantitySize9,
                QuantitySize10 = m.QuantitySize10,
                QuantitySize11 = m.QuantitySize11,
                QuantitySize12 = m.QuantitySize12,
                QuantitySize13 = m.QuantitySize13,
                QuantitySize14 = m.QuantitySize14,
                QuantitySize15 = m.QuantitySize15,
                QuantitySize16 = m.QuantitySize16,
                QuantitySize17 = m.QuantitySize17,
                QuantitySize18 = m.QuantitySize18,
                QuantitySize19 = m.QuantitySize19,
                QuantitySize20 = m.QuantitySize20,
                QuantitySize21 = m.QuantitySize21,
                QuantitySize22 = m.QuantitySize22,
                QuantitySize23 = m.QuantitySize23,
                QuantitySize24 = m.QuantitySize24,
                QuantitySize25 = m.QuantitySize25,
                QuantitySize26 = m.QuantitySize26,
                QuantitySize27 = m.QuantitySize27,
                QuantitySize28 = m.QuantitySize28,
                QuantitySize29 = m.QuantitySize29,
                QuantitySize30 = m.QuantitySize30,

                CostSize1 = m.CostSize1,
                CostSize2 = m.CostSize2,
                CostSize3 = m.CostSize3,
                CostSize4 = m.CostSize4,
                CostSize5 = m.CostSize5,
                CostSize6 = m.CostSize6,
                CostSize7 = m.CostSize7,
                CostSize8 = m.CostSize8,
                CostSize9 = m.CostSize9,
                CostSize10 = m.CostSize10,
                CostSize11 = m.CostSize11,
                CostSize12 = m.CostSize12,
                CostSize13 = m.CostSize13,
                CostSize14 = m.CostSize14,
                CostSize15 = m.CostSize15,
                CostSize16 = m.CostSize16,
                CostSize17 = m.CostSize17,
                CostSize18 = m.CostSize18,
                CostSize19 = m.CostSize19,
                CostSize20 = m.CostSize20,
                CostSize21 = m.CostSize21,
                CostSize22 = m.CostSize22,
                CostSize23 = m.CostSize23,
                CostSize24 = m.CostSize24,
                CostSize25 = m.CostSize25,
                CostSize26 = m.CostSize26,
                CostSize27 = m.CostSize27,
                CostSize28 = m.CostSize28,
                CostSize29 = m.CostSize29,
                CostSize30 = m.CostSize30,
                IsActive = m.IsActive,

                autoCompleteProductName=m.Product.ProductSKU,
                autoCompleteColorName=m.Color.Code,
                
                
            }).ToList();
            return Ok(OrderList);
        }
[HttpPost]
[Route("getValue")]
public List<PurchaseOrderItem> GetSearchValue(PurchaseOrderSearch model)
        {
            var list = Entities.PurchaseOrderItems.Where(x=>x.IsActive==true && x.PurchaseOrderId==model.PurchaseOrderId).Include(x=>x.Product).Include(x=>x.ProductStyle);
            if(model!=null)
            {
                if (!string.IsNullOrEmpty(model.autoCompleteProductName))
                {
                    list = list.Where(x => x.Product.ProductSKU == model.autoCompleteProductName);
                }
                if (!string.IsNullOrEmpty(model.autoCompleteProductStyleName))
                {
                    list = list.Where(x => x.ProductStyle.StyleSKU == model.autoCompleteProductStyleName);
                }
            }
            return list.ToList().RemoveReferences();
        }
        // delete DeletePurchaseOrderItems
        [HttpPost]
        [Route("DeletePurchaseOrderItems")]
        public IHttpActionResult DeletePurchaseOrderItems(int id)
        {
            DAL.PurchaseOrderItem order = new DAL.PurchaseOrderItem();
            order = Entities.PurchaseOrderItems.Where(s => s.ID == id).FirstOrDefault();
            order.IsActive = false;
            Entities.SaveChanges();
            return Ok(true);
        }

        //GetPurchaseOrderItemsById
        [Route("GetPurchaseOrderItemsById")]
        public IHttpActionResult GetPurchaseOrderItemsById(int id)
        {
            var orderItem = Entities.PurchaseOrderItems.Include(s=>s.Color).Include(s=>s.Product).Include(s=>s.SizeGrid).Include(s=>s.ProductStyle).Where(s => s.IsActive == true && s.ID == id).ToList().Select(m => new Model.PurchaseOrderItemModel
            {
                ID=m.ID,
                PurchaseOrderId = m.PurchaseOrderId,
                ProductId = m.ProductId,
                Amount = m.Amount,
                SizeGridId = m.SizeGridId,
                ColorId = m.ColorId,
                SuplierStyle = m.SuplierStyle,
                ProductStyleId = m.ProductStyleId,

                ItemSize1 = m.ItemSize1,ItemSize2 = m.ItemSize2,ItemSize3 = m.ItemSize3,ItemSize4 = m.ItemSize4,ItemSize5 = m.ItemSize5,
                ItemSize6 = m.ItemSize6,ItemSize7 = m.ItemSize7,ItemSize8 = m.ItemSize8,ItemSize9 = m.ItemSize9,ItemSize10 = m.ItemSize10,
                ItemSize11 = m.ItemSize11,ItemSize12 = m.ItemSize12,ItemSize13 = m.ItemSize13,ItemSize14 = m.ItemSize14,ItemSize15 = m.ItemSize15,
                ItemSize16 = m.ItemSize16,ItemSize17 = m.ItemSize17,ItemSize18 = m.ItemSize18,ItemSize19 = m.ItemSize19,ItemSize20 = m.ItemSize20,
                ItemSize21 = m.ItemSize21,ItemSize22 = m.ItemSize22,ItemSize23 = m.ItemSize23,ItemSize24 = m.ItemSize24,ItemSize25 = m.ItemSize25,
                ItemSize26 = m.ItemSize26,ItemSize27 = m.ItemSize27,ItemSize28 = m.ItemSize28,ItemSize29 = m.ItemSize29,ItemSize30 = m.ItemSize30,

                QuantitySize1 = m.QuantitySize1,QuantitySize2=m.QuantitySize2,QuantitySize3=m.QuantitySize3,QuantitySize4=m.QuantitySize4,
                QuantitySize5 = m.QuantitySize5,QuantitySize6 = m.QuantitySize6,QuantitySize7 = m.QuantitySize7,QuantitySize8 = m.QuantitySize8,
                QuantitySize9 = m.QuantitySize9,QuantitySize10 = m.QuantitySize10,QuantitySize11 = m.QuantitySize11,QuantitySize12 = m.QuantitySize12,
                QuantitySize13 = m.QuantitySize13,QuantitySize14 = m.QuantitySize14,QuantitySize15 = m.QuantitySize15,QuantitySize16 = m.QuantitySize16,
                QuantitySize17 = m.QuantitySize17,QuantitySize18 = m.QuantitySize18,QuantitySize19 = m.QuantitySize19,QuantitySize20 = m.QuantitySize20,
                QuantitySize21 = m.QuantitySize21,QuantitySize22 = m.QuantitySize22,QuantitySize23 = m.QuantitySize23,QuantitySize24 = m.QuantitySize24,
                QuantitySize25 = m.QuantitySize25,QuantitySize26 = m.QuantitySize26,QuantitySize27 = m.QuantitySize27,QuantitySize28 = m.QuantitySize28,
                QuantitySize29 = m.QuantitySize29,QuantitySize30 = m.QuantitySize30,

                CostSize1 = m.CostSize1,CostSize2 = m.CostSize2,CostSize3 = m.CostSize3,CostSize4 = m.CostSize4,CostSize5 = m.CostSize5,
                CostSize6 = m.CostSize6,CostSize7 = m.CostSize7,CostSize8 = m.CostSize8,CostSize9 = m.CostSize9,CostSize10 = m.CostSize10,
                CostSize11 = m.CostSize11,CostSize12 = m.CostSize12,CostSize13 = m.CostSize13,CostSize14 = m.CostSize14,CostSize15 = m.CostSize15,
                CostSize16 = m.CostSize16,CostSize17 = m.CostSize17,CostSize18 = m.CostSize18,CostSize19 = m.CostSize19,CostSize20 = m.CostSize20,
                CostSize21 = m.CostSize21,CostSize22 = m.CostSize22,CostSize23 = m.CostSize23,CostSize24 = m.CostSize24,CostSize25 = m.CostSize25,
                CostSize26 = m.CostSize26,CostSize27 = m.CostSize27,CostSize28 = m.CostSize28,CostSize29 = m.CostSize29,CostSize30 = m.CostSize30,
                IsActive=m.IsActive,

                autoCompleteColorName=m.Color.Code,
                autoCompleteGridName=m.SizeGrid.GridNumber,
                autoCompleteProductName=m.Product.ProductSKU,
                autoCompleteProductStyleName=m.ProductStyle.StyleSKU,
            }).FirstOrDefault();
            return Ok(orderItem);
        }

        //Update PurchaseOrderItems
        [HttpPost]
        [Route("UpdatePurchaseOrderItems")]
        public IHttpActionResult UpdatePurchaseOrderItems(PurchaseOrderItemModel OrderItem)
        {
            DAL.PurchaseOrderItem Order = new DAL.PurchaseOrderItem();
            Order = Entities.PurchaseOrderItems.Where(s => s.ID == OrderItem.ID).FirstOrDefault();
            Order.PurchaseOrderId = OrderItem.PurchaseOrderId;
            Order.ProductId = OrderItem.ProductId;
            Order.Amount = OrderItem.Amount;
            Order.ProductStyleId = OrderItem.ProductStyleId;
            Order.SizeGridId = OrderItem.SizeGridId;
            Order.ColorId = OrderItem.ColorId;
            Order.SuplierStyle = OrderItem.SuplierStyle;


            Order.ItemSize1 = OrderItem.ItemSize1; Order.ItemSize2 = OrderItem.ItemSize2; Order.ItemSize3 = OrderItem.ItemSize3; Order.ItemSize4 = OrderItem.ItemSize4;
            Order.ItemSize5 = OrderItem.ItemSize5; Order.ItemSize6 = OrderItem.ItemSize6; Order.ItemSize7 = OrderItem.ItemSize7; Order.ItemSize8 = OrderItem.ItemSize8;
            Order.ItemSize9 = OrderItem.ItemSize9; Order.ItemSize10 = OrderItem.ItemSize10; Order.ItemSize11 = OrderItem.ItemSize11; Order.ItemSize12 = OrderItem.ItemSize12;
            Order.ItemSize13 = OrderItem.ItemSize13; Order.ItemSize14 = OrderItem.ItemSize14; Order.ItemSize15 = OrderItem.ItemSize15; Order.ItemSize16 = OrderItem.ItemSize16;
            Order.ItemSize17 = OrderItem.ItemSize17; Order.ItemSize18 = OrderItem.ItemSize18; Order.ItemSize19 = OrderItem.ItemSize19; Order.ItemSize20 = OrderItem.ItemSize20;
            Order.ItemSize21 = OrderItem.ItemSize21; Order.ItemSize22 = OrderItem.ItemSize22; Order.ItemSize23 = OrderItem.ItemSize23; Order.ItemSize24 = OrderItem.ItemSize24;
            Order.ItemSize25 = OrderItem.ItemSize25; Order.ItemSize26 = OrderItem.ItemSize26; Order.ItemSize27 = OrderItem.ItemSize27; Order.ItemSize28 = OrderItem.ItemSize28;
            Order.ItemSize29 = OrderItem.ItemSize29; Order.ItemSize30 = OrderItem.ItemSize30;


            Order.QuantitySize1 = OrderItem.QuantitySize1; Order.QuantitySize2 = OrderItem.QuantitySize2; Order.QuantitySize3 = OrderItem.QuantitySize3; Order.QuantitySize4 = OrderItem.QuantitySize4;
            Order.QuantitySize5 = OrderItem.QuantitySize5; Order.QuantitySize6 = OrderItem.QuantitySize6; Order.QuantitySize7 = OrderItem.QuantitySize7; Order.QuantitySize8 = OrderItem.QuantitySize8;
            Order.QuantitySize9 = OrderItem.QuantitySize9; Order.QuantitySize10 = OrderItem.QuantitySize10; Order.QuantitySize11 = OrderItem.QuantitySize11; Order.QuantitySize12 = OrderItem.QuantitySize12;
            Order.QuantitySize13 = OrderItem.QuantitySize13; Order.QuantitySize14 = OrderItem.QuantitySize14; Order.QuantitySize15 = OrderItem.QuantitySize15; Order.QuantitySize16 = OrderItem.QuantitySize16;
            Order.QuantitySize17 = OrderItem.QuantitySize17; Order.QuantitySize18 = OrderItem.QuantitySize18; Order.QuantitySize19 = OrderItem.QuantitySize19; Order.QuantitySize20 = OrderItem.QuantitySize20;
            Order.QuantitySize21 = OrderItem.QuantitySize21; Order.QuantitySize22 = OrderItem.QuantitySize22; Order.QuantitySize23 = OrderItem.QuantitySize23; Order.QuantitySize24 = OrderItem.QuantitySize24;
            Order.QuantitySize25 = OrderItem.QuantitySize25; Order.QuantitySize26 = OrderItem.QuantitySize26; Order.QuantitySize27 = OrderItem.QuantitySize27; Order.QuantitySize28 = OrderItem.QuantitySize28;
            Order.QuantitySize29 = OrderItem.QuantitySize29; Order.QuantitySize30 = OrderItem.QuantitySize30;

            Order.CostSize1 = OrderItem.CostSize1; Order.CostSize2 = OrderItem.CostSize2; Order.CostSize3 = OrderItem.CostSize3; Order.CostSize4 = OrderItem.CostSize4;
            Order.CostSize5 = OrderItem.CostSize5; Order.CostSize6 = OrderItem.CostSize6; Order.CostSize7 = OrderItem.CostSize7; Order.CostSize8 = OrderItem.CostSize8;
            Order.CostSize9 = OrderItem.CostSize9; Order.CostSize10 = OrderItem.CostSize10; Order.CostSize11 = OrderItem.CostSize11; Order.CostSize12 = OrderItem.CostSize12;
            Order.CostSize13 = OrderItem.CostSize13; Order.CostSize14 = OrderItem.CostSize14; Order.CostSize15 = OrderItem.CostSize15; Order.CostSize16 = OrderItem.CostSize16;
            Order.CostSize17 = OrderItem.CostSize17; Order.CostSize18 = OrderItem.CostSize18; Order.CostSize19 = OrderItem.CostSize19; Order.CostSize20 = OrderItem.CostSize20;
            Order.CostSize21 = OrderItem.CostSize21; Order.CostSize22 = OrderItem.CostSize22; Order.CostSize23 = OrderItem.CostSize23; Order.CostSize24 = OrderItem.CostSize24;
            Order.CostSize25 = OrderItem.CostSize25; Order.CostSize26 = OrderItem.CostSize26; Order.CostSize27 = OrderItem.CostSize27; Order.CostSize28 = OrderItem.CostSize28;
            Order.CostSize29 = OrderItem.CostSize29; Order.CostSize30 = OrderItem.CostSize30;

            Order.IsActive = true;
            Entities.SaveChanges();

            int id = Order.PurchaseOrderId;
            return Ok(id);
        }

    }
}